---
title: Redis Output Caching
description: Learn how to use the Redis output caching integration to register an ASP.NET Core Output Caching provider backed by Redis.
---

import { Aside } from '@astrojs/starlight/components';
import InstallDotNetPackage from '@components/InstallDotNetPackage.astro';
import { Image } from 'astro:assets';
import redisIcon from '@assets/icons/redis-icon.png';

<Image
  src={redisIcon}
  alt="Redis logo"
  width={80}
  height={80}
  class:list={'float-inline-left icon'}
  data-zoom-off
/>

The [RedisÂ®](#registered-trademark) output caching integration is used to register an [ASP.NET Core Output Caching](https://learn.microsoft.com/aspnet/core/performance/caching/output) provider backed by a [Redis](https://redis.io/) server with the [`docker.io/library/redis` container image](https://hub.docker.com/_/redis/).

## Hosting integration

import InstallPackage from '@components/InstallPackage.astro';

The Redis hosting integration models a Redis resource as the `RedisResource` type. To access this type and APIs, add the [ðŸ“¦ Aspire.Hosting.Redis](https://www.nuget.org/packages/Aspire.Hosting.Redis) NuGet package in your AppHost project:

<InstallPackage packageName="Aspire.Hosting.Redis" />

### Add Redis resource

In your AppHost project, call `AddRedis` on the builder instance to add a Redis resource:

```csharp title="C# â€” AppHost.cs"
var builder = DistributedApplication.CreateBuilder(args);

var cache = builder.AddRedis("cache");

var myService = builder.AddProject<Projects.ExampleProject>()
                       .WithReference(cache);
```

When Aspire adds a container image to the AppHost, it creates a new Redis instance on your local machine.

<Aside type="tip">
  If you'd rather connect to an existing Redis instance, call `AsExisting`
  instead.
</Aside>

### Add Redis resource with data volume

To add a data volume to the Redis resource, call the `WithDataVolume` method:

```csharp title="C# â€” AppHost.cs"
var builder = DistributedApplication.CreateBuilder(args);

var cache = builder.AddRedis("cache")
                   .WithDataVolume(isReadOnly: false);

var myService = builder.AddProject<Projects.ExampleProject>()
                       .WithReference(cache);
```

The data volume is used to persist the Redis data outside the lifecycle of its container. The data volume is mounted at the `/data` path in the Redis container.

### Add Redis resource with persistence

To add persistence to the Redis resource, call the `WithPersistence` method with either the data volume or data bind mount:

```csharp title="C# â€” AppHost.cs"
var builder = DistributedApplication.CreateBuilder(args);

var cache = builder.AddRedis("cache")
                   .WithDataVolume()
                   .WithPersistence(
                       interval: TimeSpan.FromMinutes(5),
                       keysChangedThreshold: 100);

var myService = builder.AddProject<Projects.ExampleProject>()
                       .WithReference(cache);
```

The preceding code adds persistence to the Redis resource by taking snapshots of the Redis data at a specified interval and threshold.

For more Redis hosting integration options, see the main [Redis integration](/integrations/caching/redis/) page.

## Client integration

To get started with the Redis output caching integration, install the [ðŸ“¦ Aspire.StackExchange.Redis.OutputCaching](https://www.nuget.org/packages/Aspire.StackExchange.Redis.OutputCaching) NuGet package:

<InstallDotNetPackage packageName="Aspire.StackExchange.Redis.OutputCaching" />

### Add output caching

In the `Program.cs` file of your client-consuming project, call the `AddRedisOutputCache` extension method to register the required services for output caching:

```csharp
builder.AddRedisOutputCache(connectionName: "cache");
```

<Aside type="tip">
  The `connectionName` parameter must match the name used when adding the Redis
  resource in the AppHost project.
</Aside>

Add the middleware to the request processing pipeline by calling `UseOutputCache`:

```csharp
var app = builder.Build();

app.UseOutputCache();
```

For minimal API apps, configure an endpoint to do caching by calling `CacheOutput`, or by applying the `OutputCacheAttribute`:

```csharp
app.MapGet("/cached", () => "Hello world!")
   .CacheOutput();

app.MapGet(
    "/attribute",
    [OutputCache] () => "Hello world!");
```

For apps with controllers, apply the `[OutputCache]` attribute to the action method. For Razor Pages apps, apply the attribute to the Razor page class.

### Configuration

#### Use a connection string

When using a connection string from the `ConnectionStrings` configuration section:

```csharp
builder.AddRedisOutputCache(connectionName: "cache");
```

Then the connection string will be retrieved:

```json
{
  "ConnectionStrings": {
    "cache": "localhost:6379"
  }
}
```

#### Use configuration providers

The Redis output caching integration supports `Microsoft.Extensions.Configuration`. Example `appsettings.json`:

```json
{
  "Aspire": {
    "StackExchange": {
      "Redis": {
        "OutputCaching": {
          "ConnectionString": "localhost:6379",
          "DisableHealthChecks": false,
          "DisableTracing": false
        }
      }
    }
  }
}
```

#### Use inline delegates

You can pass the delegate to set up options inline:

```csharp
builder.AddRedisOutputCache(
    "cache",
    static settings => settings.DisableHealthChecks = true);
```

You can also configure the [ConfigurationOptions](https://stackexchange.github.io/StackExchange.Redis/Configuration.html#configuration-options):

```csharp
builder.AddRedisOutputCache(
    "cache",
    static settings => settings.ConnectTimeout = 3_000);
```

### Client integration health checks

By default, Aspire integrations enable health checks. The Redis output caching integration adds a health check that verifies the Redis instance is reachable.

### Observability and telemetry

#### Logging

The Redis output caching integration uses standard .NET logging.

#### Tracing

The integration emits tracing activities using OpenTelemetry.

#### Metrics

The integration emits metrics using OpenTelemetry.

:::tip[Registered trademark]{icon="information"}

<span id="registered-trademark"></span>
Redis is a registered trademark of Redis Ltd. Any rights therein are reserved to
Redis Ltd. Any use by Microsoft is for referential purposes only and does not
indicate any sponsorship, endorsement or affiliation between Redis and
Microsoft. :::
