---
title: Redis integration
description: Learn how to use the Redis integration, which includes both hosting and client integrations.
---

import { Aside } from '@astrojs/starlight/components';
import InstallPackage from '@components/InstallPackage.astro';
import InstallDotNetPackage from '@components/InstallDotNetPackage.astro';
import { Image } from 'astro:assets';
import redisIcon from '@assets/icons/redis-icon.png';

<Image
  src={redisIcon}
  alt="Redis logo"
  width={80}
  height={80}
  class:list={'float-inline-left icon'}
  data-zoom-off
/>

[RedisÂ®](#registered-trademark) is the world's fastest data platform for caching, vector search, and NoSQL databases. The Aspire Redis integration enables you to connect to existing Redis instances, or create new instances from .NET with the [`docker.io/library/redis` container image](https://hub.docker.com/_/redis/).

<Aside>
  This page covers the Redis integration. For Garnet and Valkey
  (Redis-compatible alternatives), see their respective pages.
</Aside>

## Hosting integration

The Redis hosting integration models a Redis resource as the `RedisResource` type. To access this type and APIs, add the [ðŸ“¦ Aspire.Hosting.Redis](https://www.nuget.org/packages/Aspire.Hosting.Redis) NuGet package in your AppHost project:

<InstallPackage packageName="Aspire.Hosting.Redis" />

### Add Redis resource

In your AppHost project, call `AddRedis` on the builder instance to add a Redis resource:

```csharp title="C# â€” AppHost.cs"
var builder = DistributedApplication.CreateBuilder(args);

var cache = builder.AddRedis("cache");

var myService = builder.AddProject<Projects.ExampleProject>()
                       .WithReference(cache);
```

When Aspire adds a container image to the AppHost, it creates a new Redis instance on your local machine.

<Aside type="tip">
  If you'd rather connect to an existing Redis instance, call `AsExisting`
  instead.
</Aside>

### Add Redis resource with Redis Insights

To add [Redis Insights](https://redis.io/insight/) to the Redis resource, call the `WithRedisInsight` method:

```csharp title="C# â€” AppHost.cs"
var builder = DistributedApplication.CreateBuilder(args);

var cache = builder.AddRedis("cache")
                   .WithRedisInsight();

var myService = builder.AddProject<Projects.ExampleProject>()
                       .WithReference(cache);
```

Redis Insights is a free graphical interface for analyzing Redis data across all operating systems and Redis deployments.

### Add Redis resource with Redis Commander

To add [Redis Commander](https://joeferner.github.io/redis-commander/) to the Redis resource, call the `WithRedisCommander` method:

```csharp title="C# â€” AppHost.cs"
var builder = DistributedApplication.CreateBuilder(args);

var cache = builder.AddRedis("cache")
                   .WithRedisCommander();

var myService = builder.AddProject<Projects.ExampleProject>()
                       .WithReference(cache);
```

Redis Commander is a Node.js web application used to view, edit, and manage a Redis Database.

### Add Redis resource with data volume

To add a data volume to the Redis resource, call the `WithDataVolume` method:

```csharp title="C# â€” AppHost.cs"
var builder = DistributedApplication.CreateBuilder(args);

var cache = builder.AddRedis("cache")
                   .WithDataVolume(isReadOnly: false);

var myService = builder.AddProject<Projects.ExampleProject>()
                       .WithReference(cache);
```

The data volume is used to persist the Redis data outside the lifecycle of its container. The data volume is mounted at the `/data` path in the Redis container.

### Add Redis resource with data bind mount

To add a data bind mount to the Redis resource, call the `WithDataBindMount` method:

```csharp title="C# â€” AppHost.cs"
var builder = DistributedApplication.CreateBuilder(args);

var cache = builder.AddRedis("cache")
                   .WithDataBindMount(
                       source: @"C:\Redis\Data",
                       isReadOnly: false);

var myService = builder.AddProject<Projects.ExampleProject>()
                       .WithReference(cache);
```

<Aside>
  Data bind mounts have limited functionality compared to volumes, and when you
  use a bind mount, a file or directory on the host machine is mounted into a
  container.
</Aside>

### Add Redis resource with persistence

To add persistence to the Redis resource, call the `WithPersistence` method with either the data volume or data bind mount:

```csharp title="C# â€” AppHost.cs"
var builder = DistributedApplication.CreateBuilder(args);

var cache = builder.AddRedis("cache")
                   .WithDataVolume()
                   .WithPersistence(
                       interval: TimeSpan.FromMinutes(5),
                       keysChangedThreshold: 100);

var myService = builder.AddProject<Projects.ExampleProject>()
                       .WithReference(cache);
```

The preceding code adds persistence to the Redis resource by taking snapshots of the Redis data at a specified interval and threshold.

### Connection properties

When you reference a Redis resource using `WithReference`, the following connection properties are made available to the consuming project:

#### Redis

The Redis resource exposes the following connection properties:

| Property Name | Description                                                             |
| ------------- | ----------------------------------------------------------------------- |
| `Host`        | The hostname or IP address of the Redis server                          |
| `Port`        | The port number the Redis server is listening on                        |
| `Password`    | The password for authentication                                         |
| `Uri`         | The connection URI, with the format `redis://:{Password}@{Host}:{Port}` |

**Example connection string:**

```
Uri: redis://:p%40ssw0rd1@localhost:6379
```

<Aside type="note">
  Aspire exposes each property as an environment variable named
  `[RESOURCE]_[PROPERTY]`. For instance, the `Uri` property of a resource called
  `cache` becomes `CACHE_URI`.
</Aside>

### Hosting integration health checks

The Redis hosting integration automatically adds a health check for the Redis resource. The health check verifies that the Redis instance is running and that a connection can be established to it.

### Using with non-.NET applications

The Redis hosting integration can be used with any application technology. When you use `WithReference` to reference a Redis resource, connection information is automatically injected as environment variables:

```csharp title="C# â€” AppHost.cs"
var builder = DistributedApplication.CreateBuilder(args);

var redis = builder.AddRedis("cache")
    .WithLifetime(ContainerLifetime.Persistent);

// Configure a non-.NET application with Redis access
var app = builder.AddExecutable("my-app", "python", "app.py", ".")
    .WithReference(redis) // Provides ConnectionStrings__cache
    .WithEnvironment(context =>
    {
        context.EnvironmentVariables["REDIS_HOST"] = redis.Resource.PrimaryEndpoint.Property(EndpointProperty.Host);
        context.EnvironmentVariables["REDIS_PORT"] = redis.Resource.PrimaryEndpoint.Property(EndpointProperty.Port);
    });
```

## Client integration

To get started with the Aspire Redis client integration, install the [ðŸ“¦ Aspire.StackExchange.Redis](https://www.nuget.org/packages/Aspire.StackExchange.Redis) NuGet package:

<InstallDotNetPackage packageName="Aspire.StackExchange.Redis" />

### Add Redis client

In the `Program.cs` file of your client-consuming project, call the `AddRedisClient` extension method to register an `IConnectionMultiplexer` for use via the dependency injection container:

```csharp
builder.AddRedisClient(connectionName: "cache");
```

<Aside type="tip">
  The `connectionName` parameter must match the name used when adding the Redis
  resource in the AppHost project.
</Aside>

You can then retrieve the `IConnectionMultiplexer` instance using dependency injection:

```csharp
public class ExampleService(IConnectionMultiplexer connectionMux)
{
    // Use connection multiplexer...
}
```

### Add keyed Redis client

There might be situations where you want to register multiple `IConnectionMultiplexer` instances with different connection names. To register keyed Redis clients, call the `AddKeyedRedisClient` method:

```csharp
builder.AddKeyedRedisClient(name: "chat");
builder.AddKeyedRedisClient(name: "queue");
```

Then retrieve the instances:

```csharp
public class ExampleService(
    [FromKeyedServices("chat")] IConnectionMultiplexer chatConnectionMux,
    [FromKeyedServices("queue")] IConnectionMultiplexer queueConnectionMux)
{
    // Use connections...
}
```

For more information on keyed services, see [.NET dependency injection: Keyed services](https://learn.microsoft.com/dotnet/core/extensions/dependency-injection#keyed-services).

### Configuration

#### Use a connection string

When using a connection string from the `ConnectionStrings` configuration section, you can provide the name of the connection string when calling `AddRedis`:

```csharp
builder.AddRedis("cache");
```

Then the connection string will be retrieved from the `ConnectionStrings` configuration section:

```json
{
  "ConnectionStrings": {
    "cache": "localhost:6379"
  }
}
```

For more information on how to format this connection string, see the [Stack Exchange Redis configuration docs](https://stackexchange.github.io/StackExchange.Redis/Configuration.html#basic-configuration-strings).

#### Use configuration providers

The Redis client integration supports `Microsoft.Extensions.Configuration`. It loads the `StackExchangeRedisSettings` from configuration using the `Aspire:StackExchange:Redis` key. Example `appsettings.json`:

```json
{
  "Aspire": {
    "StackExchange": {
      "Redis": {
        "ConnectionString": "localhost:6379",
        "DisableHealthChecks": false,
        "DisableTracing": false
      }
    }
  }
}
```

#### Use inline delegates

You can pass the delegate to set up options inline:

```csharp
builder.AddRedisClient(
    "cache",
    static settings => settings.DisableTracing = true);
```

### Client integration health checks

By default, Aspire integrations enable health checks for all services. The Redis integration adds a health check that verifies the Redis instance is reachable and can execute commands.

### Observability and telemetry

#### Logging

The Redis integration uses the following log categories:

- `Aspire.StackExchange.Redis`

#### Tracing

The Redis integration will emit the following tracing activities using OpenTelemetry:

- `OpenTelemetry.Instrumentation.StackExchangeRedis`

#### Metrics

The Redis integration emits metrics using OpenTelemetry.

:::tip[Registered trademark]{icon="information"}

<span id="registered-trademark"></span>
Redis is a registered trademark of Redis Ltd. Any rights therein are reserved to
Redis Ltd. Any use by Microsoft is for referential purposes only and does not
indicate any sponsorship, endorsement or affiliation between Redis and
Microsoft. :::
